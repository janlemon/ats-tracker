<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ATS – Preview</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  :root {
    --primary: rgb(0,45,84);
    --accent: rgb(228,0,70);
    --bg: #f4f4f7;
    --surface: #ffffff;
    --border: #e0e3e8;
    --text-main: #25303b;
    --text-muted: #86929d;
  }

  * { box-sizing: border-box; }
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    background: var(--bg);
  }

  .app-frame {
    margin: 16px;
    background: var(--surface);
    border-radius: 8px;
    box-shadow: 0 8px 20px rgba(15,23,42,0.12);
    overflow: hidden;
    max-height: calc(100vh - 32px);
    display: flex;
    flex-direction: column;
  }

  /* HEADER */
  .app-header {
    background: var(--primary);
    color: #fff;
    padding: 8px 16px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .app-title-block span:first-child {
    font-size: 13px;
    opacity: .75;
    display: block;
  }
  .app-title-block span:last-child {
    font-size: 20px;
    font-weight: 600;
  }

  .header-right {
    display:flex;
    align-items:center;
    gap:16px;
  }

  .user-block {
    display:flex;
    flex-direction:column;
    align-items:flex-end;
    font-size:11px;
  }

  .user-name {
    font-weight:600;
    font-size:12px;
  }

  .user-team {
    opacity:0.85;
  }

  .status-pill {
    padding: 4px 10px;
    border-radius: 999px;
    font-size: 11px;
    background: rgba(255,255,255,0.12);
  }

  .avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: rgba(255,255,255,0.18);
  }

  /* META ROW + PROGRESS */
  .app-meta {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:6px 16px;
    background:#f8f9fc;
    border-bottom:1px solid var(--border);
    gap:12px;
  }

  .meta-left {
    font-size:12px;
    color:var(--text-muted);
  }

  .meta-left span {
    color:var(--text-main);
    font-weight:500;
  }

  .meta-right {
    flex:1;
    max-width:480px;
  }

  .progress-label {
    font-size:11px;
    color:var(--text-muted);
    margin-bottom:4px;
    text-align:right;
  }

  .progress-track {
    width:100%;
    height:6px;
    border-radius:999px;
    background:#e2e6f0;
    overflow:hidden;
  }

  .progress-fill {
    height:100%;
    width:60%; /* tady si můžeš měnit procenta */
    background:linear-gradient(90deg, var(--primary), var(--accent));
  }

  .progress-steps {
    display:flex;
    justify-content:space-between;
    margin-top:4px;
    font-size:10px;
    color:var(--text-muted);
  }

  .progress-step {
    position:relative;
    padding-top:2px;
  }

  .progress-step::before {
    content:"";
    position:absolute;
    top:-6px;
    left:50%;
    transform:translateX(-50%);
    width:6px;
    height:6px;
    border-radius:50%;
    background:#cfd4e0;
  }

  .progress-step.done::before { background:#00a86b; }
  .progress-step.current::before { background:var(--primary); }

  /* ROLE TABS */
  .role-tabs {
    display:flex;
    gap:4px;
    padding: 4px 12px;
    border-bottom:1px solid var(--border);
    background:#fafbfc;
  }

  .role-tab {
    padding:4px 12px;
    border-radius:999px;
    border:1px solid transparent;
    font-size:11px;
    cursor:pointer;
    background:transparent;
    color:var(--text-muted);
  }
  .role-tab.active {
    background:rgba(0,45,84,.08);
    border-color:var(--primary);
    color:var(--primary);
  }

  /* VOTING SECTION */
  .voting-grid {
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:10px;
    margin-top:10px;
  }

  .voter-card {
    padding:8px 12px;
    border-radius:6px;
    border:1px solid var(--border);
    background:#fafbfc;
    font-size:12px;
  }

  .voter-name {
    font-weight:600;
    color:var(--text-main);
    margin-bottom:2px;
  }

  .voter-status {
    display:flex;
    align-items:center;
    gap:6px;
    font-size:11px;
  }

  /* BODY LAYOUT */
  .app-body {
    display:flex;
    flex-direction:column;
    gap:10px;
    padding:10px;
    background:var(--bg);
    overflow-y:auto;
    flex:1;
  }

  /* MAIN CONTENT AREA */
  .content-area {
    display:grid;
    grid-template-columns: 220px minmax(0,1fr);
    gap:10px;
  }

  /* STATUS SIDEBAR */
  .status-sidebar {
    display:flex;
    flex-direction:column;
    gap:6px;
  }

  .status-card {
    background:var(--surface);
    border-radius:6px;
    border:1px solid var(--border);
    padding:10px;
  }

  .status-card-title {
    font-size:12px;
    font-weight:600;
    color:var(--text-main);
    margin-bottom:8px;
    display:flex;
    align-items:center;
    gap:6px;
  }

  .status-icon {
    width:20px;
    height:20px;
    border-radius:50%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:11px;
  }

  .status-icon.pending { background:#fff3cd; color:#856404; }
  .status-icon.approved { background:#d4edda; color:#155724; }
  .status-icon.waiting { background:#e0e3e8; color:#5a6c7d; }

  .dept-status {
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:6px 8px;
    margin-bottom:4px;
    border-radius:4px;
    background:#f8f9fc;
    font-size:11px;
  }

  .dept-status:last-child {
    margin-bottom:0;
  }

  .dept-name {
    font-weight:500;
    color:var(--text-main);
  }

  .dept-email {
    font-size:10px;
    color:var(--text-muted);
    margin-top:2px;
  }

  /* WORKFLOW STEPS */
  .workflow-steps {
    background:var(--surface);
    border-radius:6px;
    border:1px solid var(--border);
    padding:8px 12px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:8px;
  }

  .workflow-step {
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:4px;
    position:relative;
    flex:1;
  }

  .workflow-step:not(:last-child)::after {
    content:"";
    position:absolute;
    right:-8px;
    top:13px;
    width:8px;
    height:2px;
    background:#e0e3e8;
  }

  .workflow-step.active::after {
    background:var(--primary);
  }

  .step-number {
    width:26px;
    height:26px;
    min-width:26px;
    border-radius:50%;
    background:#e0e3e8;
    color:#5a6c7d;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:11px;
    font-weight:600;
    position:relative;
    z-index:1;
  }

  .workflow-step.completed .step-number {
    background:#00a86b;
    color:#fff;
  }

  .workflow-step.active .step-number {
    background:var(--primary);
    color:#fff;
  }

  .step-content {
    text-align:center;
  }

  .step-title {
    font-size:10px;
    font-weight:600;
    color:var(--text-main);
    margin-bottom:0;
    white-space:nowrap;
  }

  .step-description {
    font-size:9px;
    color:var(--text-muted);
    margin-bottom:0;
    display:none;
  }

  .step-participants {
    display:flex;
    flex-wrap:wrap;
    gap:4px;
    margin-top:6px;
  }

  .participant-tag {
    padding:2px 8px;
    border-radius:999px;
    font-size:10px;
    background:rgba(0,45,84,0.08);
    color:var(--primary);
  }

  /* ATS LIST */
  .ats-list {
    background:var(--surface);
    border-radius:6px;
    border:1px solid var(--border);
    padding:8px;
  }

  .ats-list-title {
    font-size:11px;
    font-weight:600;
    color:var(--text-main);
    margin-bottom:6px;
  }

  .search-input {
    width:100%;
    padding:5px 8px;
    border-radius:4px;
    border:1px solid #d0d5dd;
    font-size:11px;
    margin-bottom:8px;
  }

  .ats-item {
    display:flex;
    gap:8px;
    padding:6px;
    border-radius:4px;
    cursor:pointer;
    margin-bottom:4px;
  }

  .ats-item:hover {
    background:#f4f6fb;
  }

  .ats-item.active {
    background:rgba(0,45,84,0.08);
    border-left:2px solid var(--primary);
  }

  .avatar-circle {
    width:28px;
    height:28px;
    min-width:28px;
    border-radius:50%;
    background:#19a974;
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:11px;
    font-weight:600;
  }

  .ats-item-info {
    flex:1;
    min-width:0;
  }

  .ats-title {
    font-size:11px;
    font-weight:600;
    color:var(--text-main);
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
  }

  .ats-sub {
    font-size:9px;
    color:var(--text-muted);
  }

  /* MODAL */
  .modal-overlay {
    display:none;
    position:fixed;
    top:0;
    left:0;
    right:0;
    bottom:0;
    background:rgba(0,0,0,0.5);
    z-index:1000;
    align-items:center;
    justify-content:center;
  }

  .modal-overlay.active {
    display:flex;
  }

  .modal-content {
    background:var(--surface);
    border-radius:12px;
    max-width:900px;
    width:90%;
    max-height:85vh;
    display:flex;
    flex-direction:column;
    box-shadow:0 20px 60px rgba(0,0,0,0.3);
  }

  .modal-header {
    padding:20px 24px;
    border-bottom:1px solid var(--border);
    display:flex;
    justify-content:space-between;
    align-items:center;
  }

  .modal-title {
    font-size:18px;
    font-weight:600;
    color:var(--text-main);
  }

  .modal-close {
    width:32px;
    height:32px;
    border-radius:50%;
    border:none;
    background:transparent;
    cursor:pointer;
    font-size:20px;
    color:var(--text-muted);
    display:flex;
    align-items:center;
    justify-content:center;
  }

  .modal-close:hover {
    background:#f0f0f0;
  }

  .modal-body {
    padding:24px;
    overflow-y:auto;
    flex:1;
  }

  .modal-footer {
    padding:16px 24px;
    border-top:1px solid var(--border);
    display:flex;
    justify-content:flex-end;
    gap:12px;
  }

  .form-section {
    margin-bottom:24px;
  }

  .form-section:last-child {
    margin-bottom:0;
  }

  .form-section-title {
    font-size:14px;
    font-weight:600;
    color:var(--text-main);
    margin-bottom:12px;
    padding-bottom:8px;
    border-bottom:1px solid var(--border);
  }

  .form-field {
    margin-bottom:16px;
  }

  .form-field label {
    display:block;
    font-size:12px;
    font-weight:500;
    color:var(--text-main);
    margin-bottom:6px;
  }

  .form-field input,
  .form-field select,
  .form-field textarea {
    width:100%;
    padding:8px 12px;
    border:1px solid #d0d5dd;
    border-radius:6px;
    font-size:13px;
    font-family:inherit;
  }

  .form-field textarea {
    min-height:80px;
    resize:vertical;
  }

  .form-field input:focus,
  .form-field select:focus,
  .form-field textarea:focus {
    outline:none;
    border-color:var(--primary);
  }

  .panel {
    background:var(--surface);
    border-radius:6px;
    border:1px solid var(--border);
    padding:10px 12px;
  }

  .panel-title {
    font-size:12px;
    font-weight:600;
    color:var(--text-main);
    margin-bottom:6px;
  }

  .panel-subtitle {
    font-size:11px;
    color:var(--text-muted);
    margin-top:-4px;
    margin-bottom:8px;
  }

  /* LEFT LIST */
  .search-input {
    width:100%;
    padding:6px 10px;
    border-radius:4px;
    border:1px solid #d0d5dd;
    font-size:13px;
    margin-bottom:10px;
  }

  .ats-item {
    display:flex;
    gap:10px;
    padding:9px 6px;
    border-radius:6px;
    cursor:pointer;
  }

  .ats-item:hover {
    background:#f4f6fb;
  }

  .avatar-circle {
    width:30px;
    height:30px;
    border-radius:50%;
    background:#19a974;
    color:#fff;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:13px;
    font-weight:600;
  }

  .ats-title {
    font-size:13px;
    font-weight:600;
    color:var(--text-main);
  }
  .ats-sub {
    font-size:11px;
    color:var(--text-muted);
  }

  /* RIGHT SIDE */
  .right {
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  .command-bar {
    display:flex;
    gap:8px;
    border-bottom:1px solid var(--border);
    padding-bottom:6px;
  }

  .cmd-btn {
    padding:5px 13px;
    border-radius:4px;
    border:1px solid #c7ccd4;
    font-size:12px;
    background:#f5f6fa;
    cursor:pointer;
  }

  .cmd-btn-primary {
    background:var(--primary);
    border-color:var(--primary);
    color:#fff;
  }

  .cmd-btn-accent {
    background:var(--accent);
    border-color:var(--accent);
    color:#fff;
  }

  .layout-main {
    display:grid;
    grid-template-rows: auto 230px;
    gap:12px;
  }

  .form-grid {
    display:grid;
    grid-template-columns: repeat(2,minmax(0,1fr));
    gap:10px 16px;
    font-size:11px;
  }

  .field-label {
    color:var(--text-main);
    margin-bottom:3px;
    font-size:11px;
  }

  .field-input {
    min-height:26px;
    border-radius:4px;
    border:1px solid #dde1e8;
    background:#ffffff;
    padding:4px 8px;
    display:flex;
    align-items:center;
    font-size:12px;
    color: var(--text-main);
  }

  .footer-buttons {
    display:flex;
    justify-content:flex-end;
    gap:8px;
    margin-top:14px;
  }

  .btn-secondary {
    padding:6px 14px;
    border-radius:4px;
    border:1px solid #c7ccd4;
    background:#fff;
    font-size:12px;
  }

  .btn-primary {
    padding:6px 16px;
    border-radius:4px;
    border:none;
    background:var(--primary);
    color:#fff;
    font-size:12px;
  }

  /* SCROLL WRAPPER FOR FORM */
  .form-wrapper {
    max-height: 260px;
    overflow-y: auto;
    padding-right: 4px;
  }

  .form-wrapper::-webkit-scrollbar {
    width: 6px;
  }
  .form-wrapper::-webkit-scrollbar-track {
    background: transparent;
  }
  .form-wrapper::-webkit-scrollbar-thumb {
    background: rgba(0,0,0,0.15);
    border-radius: 10px;
  }

  /* TRACKER + COMMENTS */
  .tracker {
    display:grid;
    grid-template-columns: 1.4fr 1.1fr;
    gap:12px;
    font-size:12px;
  }

  .timeline-item {
    position:relative;
    padding-left:18px;
    margin-bottom:6px;
  }
  .timeline-item::before {
    content:"";
    position:absolute;
    left:5px;
    top:4px;
    width:8px;
    height:8px;
    border-radius:50%;
    background:#cfd4e0;
  }
  .timeline-item.completed::before { background:#00a86b; }
  .timeline-item.current::before { background:var(--primary); }

  .timeline-title { font-weight:500; color:var(--text-main); }
  .timeline-sub   { font-size:11px; color:var(--text-muted); }

  .badge-row {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:5px;
  }

  .badge {
    padding:2px 8px;
    border-radius:999px;
    font-size:11px;
  }
  .badge-approved { background:rgba(0,168,107,0.15); color:#008f64; }
  .badge-pending  { background:rgba(255,181,0,0.18); color:#a66b00; }
  .badge-waiting  { background:rgba(0,45,84,0.08); color:var(--primary); }
  .badge-rejected { background:rgba(231,76,60,0.18); color:#c0392b; }

  .actions textarea {
    width:100%;
    min-height:70px;
    resize:vertical;
    border-radius:4px;
    border:1px solid #d0d5dd;
    padding:6px 8px;
    font-size:12px;
    margin-bottom:6px;
  }

  .actions-buttons {
    display:flex;
    justify-content:flex-end;
    gap:8px;
  }

  .btn-approve {
    padding:5px 14px;
    border-radius:4px;
    border:none;
    background:#00a86b;
    color:#fff;
    font-size:12px;
    cursor:pointer;
  }

  .btn-return {
    padding:5px 14px;
    border-radius:4px;
    border:none;
    background:#e74c3c;
    color:#fff;
    font-size:12px;
    cursor:pointer;
  }

  /* COMMENTS */
  .comments-panel {
    margin-top:4px;
    background:#f8f9fc;
    border-radius:8px;
    padding:8px 10px;
    border:1px solid #e0e3e8;
  }

  .comments-header-row {
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:4px;
  }

  .comments-title {
    font-size:12px;
    font-weight:600;
    color:var(--text-main);
  }

  .comments-counter {
    font-size:11px;
    color:var(--text-muted);
  }

  .comments-list {
    max-height:120px;
    overflow:auto;
    margin-bottom:6px;
    padding-right:4px;
  }

  .comments-list::-webkit-scrollbar {
    width: 6px;
  }
  .comments-list::-webkit-scrollbar-thumb {
    background: rgba(0,0,0,0.15);
    border-radius: 10px;
  }

  .comment-item {
    padding:6px 0;
    border-bottom:1px solid #eef0f4;
  }

  .comment-item:last-child {
    border-bottom:none;
  }

  .comment-header {
    display:flex;
    align-items:center;
    gap:8px;
    margin-bottom:2px;
  }

  .comment-avatar {
    width:22px;
    height:22px;
    border-radius:50%;
    background:#e0e5f2;
    color:var(--primary);
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:11px;
    font-weight:600;
  }

  .comment-meta {
    font-size:11px;
    color:var(--text-muted);
  }

  .comment-text {
    font-size:12px;
    color:var(--text-main);
  }

  .comment-dept {
    padding:1px 6px;
    border-radius:999px;
    font-size:10px;
    background:rgba(0,45,84,0.06);
    color:var(--primary);
  }

  .dept-comment {
    margin-bottom:6px;
  }
  .dept-comment:last-child {
    margin-bottom:0;
  }

  .role-view { display:none; }
  .role-view.active { display:block; }
</style>
</head>
<body>

<div class="app-frame">

  <!-- HEADER -->
  <div class="app-header">
    <div class="app-title-block">
      <span>Application</span>
      <span>ATS</span>
    </div>
    <div class="header-right">
      <div class="user-block">
        <div class="user-name">Jaap Smolders</div>
        <div class="user-team">Logged in · Risk team</div>
      </div>
      <div class="status-pill">In review</div>
      <div class="avatar"></div>
    </div>
  </div>

  <!-- META + PROGRESS -->
  <div class="app-meta">
    <div class="meta-left">
      Request: <span>Publication doe expectation statistical</span> · ID: ATS-2025-0123
    </div>
  </div>

  <!-- ROLE TABS -->
  <div class="role-tabs">
    <button class="role-tab active" data-role="trader">Trader View</button>
    <button class="role-tab" data-role="reviewer">Reviewer (C/R/IT)</button>
    <button class="role-tab" data-role="committee">ATS Committee</button>
    <button class="role-tab" data-role="tdo">TDO View</button>
  </div>

  <!-- BODY -->
  <div class="app-body">

    <!-- HORIZONTAL WORKFLOW TIMELINE -->
    <div class="workflow-steps">
      <div class="workflow-step completed">
        <div class="step-number">1</div>
        <div class="step-content">
          <div class="step-title">Submit</div>
        </div>
      </div>

      <div class="workflow-step completed">
        <div class="step-number">2</div>
        <div class="step-content">
          <div class="step-title">Review (C/R/IT)</div>
        </div>
      </div>

      <div class="workflow-step active">
        <div class="step-number">3</div>
        <div class="step-content">
          <div class="step-title">Finalize Wording</div>
        </div>
      </div>

      <div class="workflow-step">
        <div class="step-number">4</div>
        <div class="step-content">
          <div class="step-title">Committee Vote</div>
        </div>
      </div>

      <div class="workflow-step">
        <div class="step-number">5</div>
        <div class="step-content">
          <div class="step-title">Approved</div>
        </div>
      </div>
    </div>

    <!-- CONTENT AREA -->
    <div class="content-area">

      <!-- LEFT: ATS REQUESTS LIST -->
      <div class="ats-list">
        <div class="ats-list-title">ATS Requests</div>
        <input class="search-input" placeholder="Search..." />
        
        <div class="ats-item active">
          <div class="avatar-circle">Pd</div>
          <div class="ats-item-info">
            <div class="ats-title">Publication doe expectation</div>
            <div class="ats-sub">Jaap S. · 14/01/2025</div>
          </div>
        </div>

        <div class="ats-item">
          <div class="avatar-circle" style="background:#e74c3c;">Eq</div>
          <div class="ats-item-info">
            <div class="ats-title">Equity delta hedging</div>
            <div class="ats-sub">John D. · 10/01/2025</div>
          </div>
        </div>

        <div class="ats-item">
          <div class="avatar-circle" style="background:#3498db;">Fx</div>
          <div class="ats-item-info">
            <div class="ats-title">FX spot arbitrage</div>
            <div class="ats-sub">Anna K. · 08/01/2025</div>
          </div>
        </div>

        <div style="margin-top:12px; padding-top:8px; border-top:1px solid var(--border);">
          <div class="ats-list-title">Status Overview</div>
          <div class="dept-status" style="margin-bottom:3px; padding:4px 6px;">
            <span style="font-size:9px;">Compliance</span>
            <span class="badge badge-approved" style="font-size:8px; padding:1px 5px;">✓</span>
          </div>
          <div class="dept-status" style="margin-bottom:3px; padding:4px 6px;">
            <span style="font-size:9px;">Risk</span>
            <span class="badge badge-approved" style="font-size:8px; padding:1px 5px;">✓</span>
          </div>
          <div class="dept-status" style="margin-bottom:3px; padding:4px 6px;">
            <span style="font-size:9px;">IT</span>
            <span class="badge badge-approved" style="font-size:8px; padding:1px 5px;">✓</span>
          </div>
        </div>

      </div>

      <!-- RIGHT: ROLE-SPECIFIC CONTENT -->
      <div class="right">

      <!-- TRADER VIEW -->
      <div class="role-view active" id="view-trader">
        <div class="panel">
          <div class="panel-title">ATS Form Submission</div>
          <div class="command-bar">
            <button class="cmd-btn" id="btnNewRequest">+ New Request</button>
            <button class="cmd-btn">Edit</button>
            <button class="cmd-btn">Delete</button>
            <button class="cmd-btn-primary">Submit for Approval</button>
          </div>
        </div>

        <div class="panel">
          <div class="form-grid">
            <div>
              <div class="field-label">Sponsor</div>
              <div class="field-input">Markets</div>

              <div class="field-label">Trader / Constant supervision</div>
              <div class="field-input">Jaap Smolders</div>

              <div class="field-label">Responsible person</div>
              <div class="field-input">Angela S.</div>

              <div class="field-label">Desk name</div>
              <div class="field-input">EQ – Structured Products</div>

              <div class="field-label">Venues</div>
              <div class="field-input">XETRA, LSE, Euronext</div>

              <div class="field-label">PnL split rule per trader</div>
              <div class="field-input">50% Jaap / 50% Backup trader</div>
            </div>

            <div>
              <div class="field-label">Book name</div>
              <div class="field-input">EQ_STRAT_BOOK_01</div>

              <div class="field-label">Trader back up</div>
              <div class="field-input">John D.</div>

              <div class="field-label">Proposed go-live date</div>
              <div class="field-input">01/02/2025</div>

              <div class="field-label">Products</div>
              <div class="field-input">Equity options, delta one, swaps</div>

              <div class="field-label">Front end</div>
              <div class="field-input">Murex / Internal UI</div>

              <div class="field-label">Additional notes</div>
              <div class="field-input">Pilot phase with reduced limits.</div>
            </div>
          </div>

          <div class="footer-buttons">
            <button class="btn-secondary">Cancel</button>
            <button class="btn-primary">Submit for Approval</button>
          </div>
        </div>

        <!-- COMMUNICATION LOG -->
        <div class="panel">
          <div class="panel-title">Communication with Reviewers</div>
          <div class="comments-panel">
            <div class="comments-list">
              <div class="comment-item">
                <div class="comment-header">
                  <div class="comment-avatar">C</div>
                  <div class="comment-meta">
                    Compliance · 14:30
                  </div>
                </div>
                <div class="comment-text">
                  Please clarify the limit monitoring frequency.
                </div>
              </div>
              <div class="comment-item">
                <div class="comment-header">
                  <div class="comment-avatar">JS</div>
                  <div class="comment-meta">
                    Jaap (You) · 14:45
                  </div>
                </div>
                <div class="comment-text">
                  Real-time monitoring via Murex with daily reconciliation.
                </div>
              </div>
            </div>
            <div class="actions">
              <textarea placeholder="Reply to departments..."></textarea>
              <div class="actions-buttons">
                <button class="btn-primary">Send message</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- REVIEWER VIEW (Compliance, Risk, IT) -->
      <div class="role-view" id="view-reviewer">
        <div class="panel">
          <div class="panel-title">Department Review</div>
          <div class="command-bar">
            <button class="cmd-btn">View Full Form</button>
            <button class="cmd-btn-accent">Request Changes</button>
            <button class="cmd-btn-primary">Approve</button>
          </div>
        </div>

        <div class="panel">
          <div class="panel-title">Request Details - ATS-2025-0123</div>
          <div class="form-grid">
            <div>
              <div class="field-label">Trader</div>
              <div class="field-input">Jaap Smolders</div>

              <div class="field-label">Desk / Book</div>
              <div class="field-input">EQ – Structured Products / EQ_STRAT_BOOK_01</div>

              <div class="field-label">Products</div>
              <div class="field-input">Equity options, delta one, swaps</div>

              <div class="field-label">Venues</div>
              <div class="field-input">XETRA, LSE, Euronext</div>
            </div>
            <div>
              <div class="field-label">Go-live date</div>
              <div class="field-input">01/02/2025</div>

              <div class="field-label">Front end</div>
              <div class="field-input">Murex / Internal UI</div>

              <div class="field-label">Risk limits</div>
              <div class="field-input">Daily VaR 2m, single-name 1m</div>

              <div class="field-label">Monitoring</div>
              <div class="field-input">Real-time via Murex</div>
            </div>
          </div>
        </div>

        <!-- DEPARTMENT ASSESSMENTS -->
        <div class="panel">
          <div class="panel-title">Department Assessments</div>
          
          <div style="background:#f8f9fc; padding:12px; border-radius:6px; margin-bottom:12px;">
            <div style="font-weight:600; margin-bottom:8px; font-size:12px;">Compliance Assessment</div>
            <div class="dept-status">
              <span>Status</span>
              <span class="badge badge-approved">Approved</span>
            </div>
            <div style="font-size:12px; margin-top:8px; color:var(--text-main);">
              All compliance requirements met. Documentation complete.
            </div>
          </div>

          <div style="background:#f8f9fc; padding:12px; border-radius:6px; margin-bottom:12px;">
            <div style="font-weight:600; margin-bottom:8px; font-size:12px;">Market Risk Assessment</div>
            <div class="dept-status">
              <span>Status</span>
              <span class="badge badge-approved">Approved</span>
            </div>
            <div style="font-size:12px; margin-top:8px; color:var(--text-main);">
              Risk limits appropriate. VaR monitoring in place.
            </div>
          </div>

          <div style="background:#f8f9fc; padding:12px; border-radius:6px;">
            <div style="font-weight:600; margin-bottom:8px; font-size:12px;">IT Assessment (Lyubo)</div>
            <div class="dept-status">
              <span>Status</span>
              <span class="badge badge-pending">Your Review</span>
            </div>
            <div style="margin-top:8px;">
              <textarea style="width:100%; min-height:60px; border:1px solid #d0d5dd; border-radius:4px; padding:8px; font-size:12px;" placeholder="Add your IT assessment..."></textarea>
              <div class="actions-buttons" style="margin-top:8px;">
                <button class="btn-return">Request Changes</button>
                <button class="btn-approve">Approve</button>
              </div>
            </div>
          </div>
        </div>

        <!-- FINALIZE WORDING -->
        <div class="panel">
          <div class="panel-title">Finalize Recommendation Wording</div>
          <div class="panel-subtitle">All 3 departments must approve before this can be sent to ATS Committee</div>
          
          <div class="dept-status" style="margin-bottom:12px;">
            <span>Ready to send?</span>
            <span class="badge badge-waiting">Waiting for all approvals</span>
          </div>

          <textarea style="width:100%; min-height:100px; border:1px solid #d0d5dd; border-radius:4px; padding:12px; font-size:12px;" placeholder="Combined recommendation wording for ATS Committee...

Example:
All review departments (Compliance, Market Risk, IT) have assessed ATS-2025-0123.

Assessment summary:
✓ Compliance: All regulatory requirements met
✓ Risk: Limits appropriate, monitoring confirmed  
✓ IT: Technical validation complete

Recommendation: APPROVE for Committee review"></textarea>
          
          <div class="footer-buttons">
            <button class="btn-secondary">Save Draft</button>
            <button class="btn-primary" disabled>Send to ATS Committee</button>
          </div>
        </div>
      </div>

      <!-- COMMITTEE VIEW -->
      <div class="role-view" id="view-committee">
        <div class="panel">
          <div class="panel-title">ATS Committee - Vote Required</div>
          <div class="command-bar">
            <button class="cmd-btn">View Full Details</button>
            <button class="cmd-btn-accent">Reject</button>
            <button class="cmd-btn-primary">Approve</button>
          </div>
        </div>

        <!-- DEPARTMENTS RECOMMENDATION -->
        <div class="panel">
          <div class="panel-title">Departments Recommendation</div>
          <div style="background:#d4edda; border:1px solid #c3e6cb; padding:14px; border-radius:6px; font-size:12px; color:#155724; margin-bottom:12px;">
            All review departments (Compliance, Market Risk, IT) have assessed ATS-2025-0123.
            <br><br>
            <strong>Assessment summary:</strong><br>
            ✓ Compliance: All regulatory requirements met<br>
            ✓ Risk: Limits appropriate, monitoring confirmed<br>
            ✓ IT: Technical validation complete<br>
            <br>
            <strong>Recommendation: APPROVE</strong>
          </div>

          <div class="form-grid">
            <div>
              <div class="field-label">Trader</div>
              <div class="field-input">Jaap Smolders</div>

              <div class="field-label">Desk / Book</div>
              <div class="field-input">EQ – Structured Products / EQ_STRAT_BOOK_01</div>
            </div>
            <div>
              <div class="field-label">Products</div>
              <div class="field-input">Equity options, delta one, swaps</div>

              <div class="field-label">Go-live date</div>
              <div class="field-input">01/02/2025</div>
            </div>
          </div>
        </div>

        <!-- COMMITTEE VOTES -->
        <div class="panel">
          <div class="panel-title">Committee Members Votes</div>
          
          <div class="voting-grid">
            <div class="voter-card">
              <div class="voter-name">Suzana Hakobjan / Tomas</div>
              <div class="voter-status">
                <span class="badge badge-pending">Pending vote</span>
              </div>
            </div>
            <div class="voter-card">
              <div class="voter-name">Lyubomir Gunev</div>
              <div class="voter-status">
                <span class="badge badge-approved">Approved</span>
                <span style="color:var(--text-muted);">15:20</span>
              </div>
            </div>
            <div class="voter-card">
              <div class="voter-name">Angela McCormack</div>
              <div class="voter-status">
                <span class="badge badge-approved">Approved</span>
                <span style="color:var(--text-muted);">15:25</span>
              </div>
            </div>
          </div>

          <div style="margin-top:16px; padding:12px; background:#fff3cd; border:1px solid #ffc107; border-radius:6px; font-size:12px;">
            <strong>Your vote required</strong> (Suzana/Tomas)<br>
            After all members vote, notification will be sent to Compliance, Risk, IT, TDO
          </div>

          <div style="margin-top:12px;">
            <textarea style="width:100%; min-height:60px; border:1px solid #d0d5dd; border-radius:4px; padding:8px; font-size:12px;" placeholder="Optional comment with your vote..."></textarea>
            <div class="footer-buttons">
              <button class="btn-return">Reject</button>
              <button class="btn-primary">Approve</button>
            </div>
          </div>
        </div>
      </div>

      <!-- TDO VIEW -->
      <div class="role-view" id="view-tdo">
        <div class="panel">
          <div class="panel-title">TDO - Approval Notification</div>
          <div class="panel-subtitle">Read-only view - You receive notifications after Committee approval</div>
        </div>

        <div class="panel">
          <div class="panel-title">Approved Request - Ready for Setup</div>
          
          <div style="background:#d4edda; border:1px solid #c3e6cb; padding:14px; border-radius:6px; margin-bottom:16px;">
            <div style="font-weight:600; font-size:13px; color:#155724; margin-bottom:8px;">
              ✓ ATS Request APPROVED by Committee
            </div>
            <div style="font-size:12px; color:#155724;">
              Request ID: ATS-2025-0123<br>
              Approved: 15/01/2025 15:45<br>
              All committee members voted: Approved
            </div>
          </div>

          <div class="form-grid">
            <div>
              <div class="field-label">Trader</div>
              <div class="field-input">Jaap Smolders</div>

              <div class="field-label">Desk / Book</div>
              <div class="field-input">EQ – Structured Products / EQ_STRAT_BOOK_01</div>

              <div class="field-label">Products</div>
              <div class="field-input">Equity options, delta one, swaps</div>

              <div class="field-label">Venues</div>
              <div class="field-input">XETRA, LSE, Euronext</div>
            </div>
            <div>
              <div class="field-label">Go-live date</div>
              <div class="field-input">01/02/2025</div>

              <div class="field-label">Front end</div>
              <div class="field-input">Murex / Internal UI</div>

              <div class="field-label">Risk limits</div>
              <div class="field-input">Daily VaR 2m, single-name 1m</div>

              <div class="field-label">Monitoring</div>
              <div class="field-input">Real-time via Murex</div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="panel-title">Approval Wording & Conditions</div>
          <div style="background:#f8f9fc; padding:14px; border-radius:6px; font-size:12px; color:var(--text-main);">
            All review departments (Compliance, Market Risk, IT) have approved this request.
            <br><br>
            <strong>Conditions:</strong><br>
            • Real-time monitoring via Murex required<br>
            • Daily VaR limit: 2m EUR<br>
            • Single-name exposure limit: 1m EUR<br>
            • Standard post-trade reporting applies
          </div>

          <div style="background:#fff3cd; border:1px solid #ffc107; padding:14px; border-radius:6px; margin-top:12px; font-size:12px;">
            <strong>⚠️ TDO Action Required:</strong><br>
            Proceed with algorithm account setup according to approved specifications.
          </div>
        </div>
      </div>

    </div><!-- right -->

  </div><!-- app-body -->
</div><!-- app-frame -->

<!-- NEW ATS REQUEST MODAL -->
<div class="modal-overlay" id="newRequestModal">
  <div class="modal-content">
    <div class="modal-header">
      <div class="modal-title">Create New ATS Request</div>
      <button class="modal-close" onclick="closeModal()">×</button>
    </div>
    
    <div class="modal-body">
      <form id="atsForm">
        
        <!-- BASIC INFO -->
        <div class="form-section">
          <div class="form-section-title">Basic Information</div>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
            <div class="form-field">
              <label>Sponsor *</label>
              <select required>
                <option value="">Select sponsor...</option>
                <option value="markets">Markets</option>
                <option value="trading">Trading</option>
                <option value="other">Other</option>
              </select>
            </div>
            <div class="form-field">
              <label>Request Type *</label>
              <select required>
                <option value="">Select type...</option>
                <option value="new">New Algorithm</option>
                <option value="modification">Modification</option>
                <option value="decommission">Decommission</option>
              </select>
            </div>
          </div>
          
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
            <div class="form-field">
              <label>Trader / Constant Supervision *</label>
              <input type="text" required placeholder="e.g., Jaap Smolders" />
            </div>
            <div class="form-field">
              <label>Trader Backup *</label>
              <input type="text" required placeholder="e.g., John D." />
            </div>
          </div>

          <div class="form-field">
            <label>Responsible Person *</label>
            <input type="text" required placeholder="e.g., Angela S." />
          </div>
        </div>

        <!-- DESK & BOOK -->
        <div class="form-section">
          <div class="form-section-title">Desk & Book Information</div>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
            <div class="form-field">
              <label>Desk Name *</label>
              <input type="text" required placeholder="e.g., EQ – Structured Products" />
            </div>
            <div class="form-field">
              <label>Book Name *</label>
              <input type="text" required placeholder="e.g., EQ_STRAT_BOOK_01" />
            </div>
          </div>
        </div>

        <!-- TRADING DETAILS -->
        <div class="form-section">
          <div class="form-section-title">Trading Details</div>
          
          <div class="form-field">
            <label>Products *</label>
            <input type="text" required placeholder="e.g., Equity options, delta one, swaps" />
          </div>

          <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
            <div class="form-field">
              <label>Venues *</label>
              <input type="text" required placeholder="e.g., XETRA, LSE, Euronext" />
            </div>
            <div class="form-field">
              <label>Front End *</label>
              <input type="text" required placeholder="e.g., Murex / Internal UI" />
            </div>
          </div>

          <div class="form-field">
            <label>Proposed Go-Live Date *</label>
            <input type="date" required />
          </div>
        </div>

        <!-- RISK & LIMITS -->
        <div class="form-section">
          <div class="form-section-title">Risk & Limits</div>
          
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:16px;">
            <div class="form-field">
              <label>Daily VaR Limit</label>
              <input type="text" placeholder="e.g., 2m EUR" />
            </div>
            <div class="form-field">
              <label>Single-Name Limit</label>
              <input type="text" placeholder="e.g., 1m EUR" />
            </div>
          </div>

          <div class="form-field">
            <label>PnL Split Rule per Trader</label>
            <input type="text" placeholder="e.g., 50% Jaap / 50% Backup trader" />
          </div>

          <div class="form-field">
            <label>Monitoring Approach</label>
            <textarea placeholder="Describe monitoring setup (e.g., Real-time via Murex with daily reconciliation)"></textarea>
          </div>
        </div>

        <!-- OPERATIONAL -->
        <div class="form-section">
          <div class="form-section-title">Operational Details</div>
          
          <div class="form-field">
            <label>Kill Switch Responsible</label>
            <input type="text" placeholder="e.g., Trading floor duty officer" />
          </div>

          <div class="form-field">
            <label>Additional Notes</label>
            <textarea placeholder="Any additional information, conditions, or remarks..."></textarea>
          </div>
        </div>

      </form>
    </div>
    
    <div class="modal-footer">
      <button class="btn-secondary" onclick="closeModal()">Cancel</button>
      <button class="btn-secondary">Save Draft</button>
      <button class="btn-primary" onclick="submitATS()">Submit for Approval</button>
    </div>
  </div>
</div>

<script>
  // Role tabs
  document.querySelectorAll('.role-tab').forEach(btn => {
    btn.addEventListener('click', () => {
      const role = btn.getAttribute('data-role');
      document.querySelectorAll('.role-tab').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.role-view').forEach(v => v.classList.remove('active'));
      document.getElementById('view-' + role).classList.add('active');
    });
  });

  // Modal functions
  function openModal() {
    document.getElementById('newRequestModal').classList.add('active');
  }

  function closeModal() {
    document.getElementById('newRequestModal').classList.remove('active');
  }

  function submitATS() {
    // Here you would handle form submission
    alert('ATS Request submitted! (This would send to review teams and committee)');
    closeModal();
  }

  // New Request button
  document.getElementById('btnNewRequest')?.addEventListener('click', openModal);

  // Close modal on overlay click
  document.getElementById('newRequestModal')?.addEventListener('click', (e) => {
    if (e.target.id === 'newRequestModal') {
      closeModal();
    }
  });

  // Close modal on ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
</script>

</body>
</html>